%\chapter{Введение в полулагранжевые методы для потоков геофизического масштаба} \label{chapt0}
\chapter*{Глава 1. Введение} \label{chapt1}

Полулагражевый метод является способом численного решения уравнений в частных производных, которые описывают процесс переноса. Данный метод учитывает лагранжевую природу процесса переноса, однако в тоже время, позволяет работать на фиксированной вычислительной сетке. Взяв за начало первые предложения в метеорологической литературе, которые фокусировались на переносе вихря в упрощенных моделях крупномасштабного потока, метод трансформировался в законченый метод дискретизации для полных уравнений атмосферных потоков. Полулагржевый метод также связан (а, в некоторых случаях, полностью эквивалентен) с аналогичными методами, разработанными в других сферах моделирования, такими как, например, модифицированный метод характеристик, метод Эйлера-Лангранжа и харатеристический метод Галеркина. 

Исчерпывающий обзор полулагранжевого метода в метеорологической литературе до 1990 года предствален в [67]. Обзоры разработок, посвященных смежным методам в других областях моделирования, могут быть найдены, например, в [15], [43], [56].

Краткое описание данной вводной статьи представлено ниже. В разделе 2 представлена базовая концепция полулугранжевого метода, а также простейшие положения для линейного одномерного уравнения переноса. Кроме того, описаны разница и связь с сугубо лагранжевыми методами. В разделе 3, в ключе классического метео масштабного анализа, рассмотрена особая роль процесса переноса для крупномасштабного атмосферного потока. В разделе 4 кратко освещен процесс разработки полулагражевых методов вкупе с некоторыми паралелльными разработками в других научных сферах. В разделе 5 описаны некоторые из возможных способов реализации ключевых этапов в полулуагранжевом методе. В разделе 6 представлены результаты простых численных тестов для одномерного и двумерного случая изолированного (passive) переноса с целью показать как метод может быть реализован на практике. Затем, результаты сравниваются с аналогичными элеровыми схемами. В разделе 7 обсуждеается устойчивость и сходимость метода.

Первая версия данного обзора полулагранжевых методов была осуществлена, благодаря приглашению на семинар по прикладной математике на ETH Zurich, чтобы прочитать серию докладов по данной тематике в рамках программы ERCOFTAC в июле 2004. Я хотел бы поблагодарить профессоров Рольфа Джелтча (Rolf Jeltsch) и Виллияма Сойера (William Sawyer) за поддержку этого начинания и базовую концепцию данного обзора.

Мой первый персональный опыт работы с полулагражевыми методами был получен в 1993 году в ходе моей работы над кандидатской диссертацией под руководством профессора Винчензо Касулли (Vincenzo Casulli, University of Trento, Italy). Я хотел бы поблагодарить его за мое посвящение как и в данную восхитительную область, так и в мир практического численного моделирования. Всевозможные обсуждения с доктором Эндрю Станифортом (Andrew Staniforth, Met Office, UK) также были весьма важны в рамках углубления моего понимания данных методов и  проблем численного прогнозирования погоды в целом.

Мой опыт с полулагранжевыми методами также был углублен, благодаря обсуждениям и помощи моих многих друзей и коллег. Я хотел бы поблагодарить их всех за помощь и советы.

\newpage
%============================================================================================================================

\chapter*{Глава 2. Полулагранжевый метод для линейного уравнения переноса} \label{chapt_2}
Для того, чтобы познакомиться с полулагранжевым методом в простом контексте, рассмотрим одномерное линейное уравнение переноса
%
\begin{equation}
\label{eq:equation2_1}
\frac{\partial c}{\partial t} + u\frac{\partial c}{\partial x} = 0
\end{equation}
%
с постоянным коэфициентом $u$ и с начальными данными $c_0(x), x\in{\mathbf{R}}$. Общеизвестно, что
%
\begin{equation}
\label{eq:equation2_2}
c(c,t)=c_0(x - ut)
\end{equation}
%
Теперь рассмотрим дискретизацию уравнения \eqref{eq:equation2_1} на равномерной одномерной сетке с шагом по пространству $\Delta x$ и временным шагом $\Delta t$. Обозначим узлы сетки как $i$, а дискретные временные уровни как $n$. Тогда пространсвенно-временные позиции на сетке могут быть обозначены $x_i=i\Delta{x}$, $t^n=n\Delta{t}$, а приближенные значения, вычисленные при помощи численного решения, как $c^n\approx c(x_i, t^n)$. Стандартные конечно-разностные методы основаны на аппроксимации дифференциальных операторов конечно-разностными приращениями. Рассмотрим некоторые типовые примеры. Одним из наиболее простых методов является противопотоковый метод, в котором для аппроксимации используются односторонние конечно-разностные приращения

%
\begin{equation}
\label{eq:equation2_3}
\frac{c_i^{n+1}-c_i^n}{\Delta t} + u\frac{c_i^n-c_{i-1}^{n}}{\Delta x} = 0
\end{equation}
%
Здесь предполагается, что $u\ge0$, а направление задано положительно (Here, it was assumed that u>=0 and the direction). Противопотоковый метод обладает первым порядоком аппроксимации по времени и пространству. Информация о противопотоковых методах высокого порядка представлена, например, в [12]. Метод с перешагиванием использует центральные конечные разности по времени и пространству
%
\begin{equation}
\label{eq:equation2_4}
\frac{c_i^{n+1}-c_i^{n-1}}{2\Delta t} + u\frac{c_{i+1}^n-c_{i-1}^{n}}{2\Delta x} = 0
\end{equation}
%
Итоговый метод имеет второй порядок аппроксимации по пространству и времени. Применение более точной аппроксимации пространственной производной может дать высокоточные схемы по пространству и времени. Например, взяв центральные разности по времени и аппроксимацию четвертого порядка производной по $x$ (например, см. [14]), получим
%
\begin{equation}
\label{eq:equation2_5}
\frac{c_i^{n+1}-c_i^{n-1}}{2\Delta t} + u\Big[\frac{4}{3}\frac{c_{i+1}^n-c_{i-1}^n}{2\Delta x}-\frac{1}{3}\frac{c_{i+2}^n-c_{i-2}^n}{4\Delta x}\Big] = 0.
\end{equation}
%
Упомянутые методы являются трехшаговыми по времени, потому требуют использования особой аппроксимации для вычисления первого шага по времени. Примером двухшагового по времени метода, который имеет второй порядок аппроксимации, является метод Лакса"--~Вендроффа
%
\begin{equation}
\label{eq:equation2_6}
\frac{c_i^{n+1}-c_i^n}{\Delta t} + u\frac{c_i^n-c_{i-1}^n}{2\Delta x} - \frac{u^2\Delta t}{2}\frac{c_{i+1}^n-2c_i^n+c_{i-1}^n}{\Delta x^2} = 0,
\end{equation}
%
который может быть  интерпретирован как устойчивая версия (неустойчивой) схемы
%
\begin{equation}
\label{eq:equation2_7}
\frac{c_i^{n+1}-c_i^n}{\Delta t} + u\frac{c_{i+1}^n-c_{i-1}^n}{2\Delta x} = 0,
\end{equation}
%
полученной добавлением численной диссипации в особом виде (например, см. [56]). Общеизвестно, что устойчивость этих методов зависит в основном от параметра $C=u\Delta t/\Delta x$, также известного как число Куранта. Основное условие для устойчивости это, фактически, $\left|C\right|\le1$, которое также известно как условие Куранта"--~Фридрихса"--~Леви (КФЛ) (см. [10]).

Лагранжевые и полулагранжевые методы, в свою очередь, используют характерную особенность уравнения переноса, а именно представление точного решения через начальные данные. В частности, рассмотрев без потери общности случай $u\ge0$, можно обнаружить, что имеют место два следующих уравнения
%
\begin{equation}
\label{eq:equation2_8}
\begin{split}
c (x_i, t^n) & = c_0(x_i - un\Delta t) {} \\
		     & {} = c_0(x_i + u\Delta t - u(n+1)\Delta t) = c(x_i + u\Delta t, t^{n+1})
\end{split}
\end{equation}
%
%
\begin{equation}
\label{eq:equation2_9}
\begin{split}
c (x_i, t^{n+1}) & = c_0(x_i - u(n+1)\Delta t) {} \\
& {} = c_0(x_i - u\Delta t - un\Delta t) = c(x_i - u\Delta t, t^{n})
\end{split}
\end{equation}
%
Уравнение \eqref{eq:equation2_9} является основой для чистых лагранжевых методов. Особая природа точного решения уравнения \eqref{eq:equation2_1} позволяет использовать информацию о решении в точке сетки в момент времени $n$, чтобы вывести значение решения в момент времени $n+1$ в точках сетки, которые \textit{переместились с потоком}. В результате того, что сетку необходимо менять на каждом временном шаге, практическое приложение лагранжевых методов неэффективно и данные методы никогда не становились действующими (opreational) инструментами в прогнозе погоды или крупномасштабных атмосферных симуляциях.

Уравнение \eqref{eq:equation2_10} обеспечивает основу для полулугранжевого метода. Вновь используется особая природа точного решения \eqref{eq:equation2_1}, чтобы выразить значение решения в узлах сетки на временном шаге $n+1$ через значения решения на временном шаге $n$ в тех узлах сетки, которые \textit{будут перенесены потоком} на вычислительную сетку за один временной шаг.
Тот факт, что сетка не изменяется во времени, имеет практическое преимущество, которое является одной из фундаментальных причин для гораздо более широкого использования полулагранжевых методов, нежели чисто лагранжевых. Дискретное определение полулагранжевого метода может быть получено из уравнения \eqref{eq:equation2_10} (\textbf{ТУТ ЯВНАЯ ОШИБКА, видимо имеется ввиду некоторое уравнение представленное выше}) как
%
\begin{equation}
\label{eq:equation2_10}
c_i^{n+1} = c_{i-u\frac{\Delta t}{\Delta x}}^{n} = c_{i-k-\alpha}^n \quad u\frac{\Delta t}{\Delta x} = k + \alpha \quad k = \Big[u\frac{\Delta t}{\Delta x}\Big].
\end{equation}
%

$k$ and $\alpha$ часто называют целым и дробным числами Куранта, соответственно. Выражение $c_{i-k-\alpha}^n$ может быть интерпретировано как значение, полученное из приближенных значений $c^n$ в точке $i\Delta x - u\Delta t$ с использованием некоторой интерполяционной процедуры. Применив линейную интерполяцию, можно сразу получить два интересных факта
%
\begin{equation}
\label{eq:equation2_11}
c_i^{n+1} = \alpha c_{i-k-1}^{n} + (1-\alpha)c_{i-k}^n.
\end{equation}
%
Во первых, если $C = u\Delta t/\Delta x < 1$, тогда имеем в \eqref{eq:equation2_11} $k=0$, $C=\alpha$ и  легко увидеть, что итоговый метод идентичен противопотоковому методу \eqref{eq:equation2_3}. Более того,
ясно, что \eqref{eq:equation2_11} выполняется для любого значения числа Куранта и что, поскольку значения решения на новом временном слое $n+1$ получены с использованием линейной интерполяции значений на временном слое $n$ с неотрицательными коэффициентами, выполняется дискретный принцип максимума, т. е.
%
\begin{equation}
\label{eq:equation2_12}
\min_i c_i^0 \le \min_i c_i^n \le \max_i c_i^n \le \max_i c_i^0
\end{equation}
%
для любого $n$. Это также подразумевает устойчивость в максимум-норме для произвольного числа Куранта. Таким образом, по крайней мере в простом случае, полулагранжевый метод, очевидно, имеет большое преимущество над рассмотренными ранее эйлеровыми методами, поскольку отсутсвует условие устойчивости, ограничивающее выбор временного шага.

Полулагранжевый метод может быть легко обобщен на многомерный случай. Рассмотрим поле постоянных скоростей $\mathbf{u}\in\mathbf{R}^d$ и начальное условие $c_0(x), x\in\mathbf{R}^d$. Тогда многомерное линейное уравнение адвекции имеет вид
%
\begin{equation}
\label{eq:equation2_13}
\frac{\partial{c}}{\partial{t}} + \mathbf{u} \cdot \nabla c = 0.
\end{equation}
%
Как и в одномерном случае, аналитическое решение представимо в виде
%
\begin{equation}
\label{eq:equation2_14}
c(\mathbf{x}, t) = c_0(\mathbf{x} - \mathbf{u}t),
\end{equation}
%
и полулагражевый метод может быть выведен как и в одномерном случае, лишь заменив одномерную интерполяцию на многомерную.
	
В более общем случае, когда поле скоростей $\mathbf{u} (\mathbf{x},t)\in\mathbf{R}^d$ зависит от простанства и времени, имеем
%
\begin{equation}
\label{eq:equation2_15}
\frac{dc}{dt}=\frac{\partial{c}}{\partial{t}} + \mathbf{u}(\mathbf{x}, t) \cdot \nabla c = 0.
\end{equation}
%
Здесь была введена обычная запись $dc/dt$ для обозначения лагранжевой производной. Полагая, для поля скоростей верны некоторые предположения о непрерывности (оно должно быть непрерывным по Липшицу, например, см. [56]), можно доказать, что существует функция линий тока или характеристическая функция. Они опеределены как решения $\mathbf{X}(t;s, \mathbf{x})$ обыкновенных дифференциальных уравнений
%
\begin{equation}
\label{eq:equation2_16}
\frac{d}{dt}\mathbf{X}(t;s,\mathbf{x})=\mathbf{u}(\mathbf{X}(t; s, \mathbf{x}), t)
\end{equation}
%
с начальным условием в момент времени $s$, заданным как $\mathbf{X}(t;s,\mathbf{x})=\mathbf{x}$. Для гладких начальных данных по цепному правилу доказуемо, что
%
\begin{equation}
\label{eq:equation2_17}
c(\mathbf{x}, t) = c_0(\mathbf{X}(0;t,\mathbf{x})).
\end{equation}
%
Это показывает, что доказательство, аналогичное упомянутому, справедливо для численного метода основанного на полугагражевом подходе, однако при условии, что получено численное решение уравнения \eqref{eq:equation2_16}. Таким образом, подводя итог, можно сказать, что, используя формулу \eqref{eq:equation2_17}, полулагранжевые методы сводят аппроксимацию уравнения переноса \eqref{eq:equation2_15} к следующим ключевым шагам:
\begin{itemize}
	\item на заданом слое по времени $n$, для каждой точки сетки $x$ вычислить приближенное решение \eqref{eq:equation2_16} для определения оценки $\mathbf{X}^*(t^n;t^{n+1}, \mathbf{x})$
	\item вычислить аппроксимацию уравнения \eqref{eq:equation2_17} путем интерполяции значений в узлах сетки на временном слое $n$ в точках $\mathbf{X}^*(t^n;t^{n+1}, \mathbf{x})$.
\end{itemize}
Это подразумевает что решение ДУЧП \eqref{eq:equation2_15} сведено к решению большого набора взаимно независимых ОДУ и многомерной интерполяции. Для каждого из этих шагов доступен ряд классических и хорошо изученных методов.
\newpage
\chapter*{Глава 3. Роль адвекции в потоках геофизических масштабов} \label{chapt_3}
\chapter*{Глава 4. Историческое развитие полулагражевых методов} \label{chapt_4}
\chapter*{Глава 5. Практика полулагражевых методов} \label{chapt_5}
\section*{Методы аппроксимации траекторий} \label{sect5_1}
\section*{Методы интерполяции} \label{sect5_2}
\chapter*{Глава 6. Численные эксперименты: одно- и двумерный пассивный перенос} \label{chapt_6}
\section*{Одномерная адвекция} \label{sect6_1}
\section*{Двумерная адвекция} \label{sect6_2}
\section*{Сравнение с простыми эйлеровыми схемами} \label{sect6_3}
\chapter*{Глава 7. Теория полулагражевых методов: анализ сходимости и устойчивости} \label{chapt_7}
\chapter*{Глава 8. Полулагранжевые методы против метода характеристик: полунеявные полулагранжевые методы
	 для условий с малым числом Фруда} \label{chapt_8}
\chapter*{Глава 9. Консервативные(mass conservative) и векторные (flux form) полузагранжевые методы} \label{chapt_9}
\newpage
\chapter*{Глава 10. Выводы} \label{chapt_10}
Был представлен полулагранжевый метод решения уравнения переноса, а также рассмотрено его развитие в контексте атмосферного моделирования за последние 50 лет. Были рассмотрены его простейшие свойства и приведен обзор базовых теоретических свойств. В частности, предпринята попытка применить методы, разработанные для атмосферного моделирования, в более широкой перспективе современных методов конечных объемов и конечных разностей, вместе с набросками предложенными К. В. Мортоном в [43]. Возможно, осмысление сильно выраженных сходств между современными, полностью многомерными адвективными схемами поможет утихомирить многичисленные дебаты относительно достоиств эйлеровых и лагранжевых схем.
%\newpage